{"paragraphs":[{"text":"import java.sql.Connection\nimport java.sql.Statement\nimport java.sql.DriverManager\nval url = \"jdbc:mysql://awsdb.c3ucbmcnj8sv.ap-northeast-2.rds.amazonaws.com:3306/awsdb?characterEncoding=UTF-8\"\nval user: String =\"awsdb\"\nval pass: String=\"awsdb123\" \n\nval prop = new java.util.Properties\nprop.setProperty(\"driver\", \"com.mysql.jdbc.Driver\")\nprop.setProperty(\"user\", user)\nprop.setProperty(\"password\",pass) \n\n","user":"anonymous","dateUpdated":"2019-09-24T01:25:37+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import java.sql.Connection\nimport java.sql.Statement\nimport java.sql.DriverManager\nurl: String = jdbc:mysql://awsdb.c3ucbmcnj8sv.ap-northeast-2.rds.amazonaws.com:3306/awsdb?characterEncoding=UTF-8\nuser: String = awsdb\npass: String = awsdb123\nprop: java.util.Properties = {user=awsdb, password=awsdb123, driver=com.mysql.jdbc.Driver}\nres8: Object = null\n"}]},"apps":[],"jobName":"paragraph_1569251114898_599700260","id":"20190923-150514_1060220031","dateCreated":"2019-09-23T15:05:14+0000","dateStarted":"2019-09-24T01:25:37+0000","dateFinished":"2019-09-24T01:25:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:21745"},{"text":" val databaseQuery = \"\"\"(\n \nCREATE DATABASE zzdm CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;\n\n ) a\"\"\"\n \nval schema = spark.read.format(\"jdbc\").option(\"url\", url).option(\"dbtable\", databaseQuery).option(\"user\",user).option(\"password\", pass).option(\"useUnicode\", \"true\").option(\"characterEncoding\",\"utf8\").load()","user":"anonymous","dateUpdated":"2019-09-24T02:43:25+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1569292295580_-2040550443","id":"20190924-023135_486701672","dateCreated":"2019-09-24T02:31:35+0000","dateStarted":"2019-09-24T02:43:25+0000","dateFinished":"2019-09-24T02:43:25+0000","status":"ERROR","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:21746"},{"title":"1. order_info.csv db insert","text":"val orderInfoDF = spark.read.\noption(\"header\",\"true\").\noption(\"inferSchema\", \"true\").\ncsv(\"s3://awskrug-data-njk/csv/order_info.csv\")","user":"anonymous","dateUpdated":"2019-09-24T01:25:41+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"orderInfoDF: org.apache.spark.sql.DataFrame = [timestamp: timestamp, user_id: string ... 3 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-3-26.ap-northeast-2.compute.internal:4040/jobs/job?id=7","http://ip-172-31-3-26.ap-northeast-2.compute.internal:4040/jobs/job?id=8"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1569250372540_-1766077477","id":"20190923-145252_256979512","dateCreated":"2019-09-23T14:52:52+0000","dateStarted":"2019-09-24T01:25:41+0000","dateFinished":"2019-09-24T01:25:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21747"},{"title":"1.1 Schema 확인","text":"orderInfoDF.printSchema","user":"anonymous","dateUpdated":"2019-09-24T01:25:47+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- timestamp: timestamp (nullable = true)\n |-- user_id: string (nullable = true)\n |-- goods_id: integer (nullable = true)\n |-- shop_id: integer (nullable = true)\n |-- price: integer (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1569250866442_53027547","id":"20190923-150106_1561853165","dateCreated":"2019-09-23T15:01:06+0000","dateStarted":"2019-09-24T01:25:47+0000","dateFinished":"2019-09-24T01:25:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21748"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1569288363640_-36316235","id":"20190924-012603_778072749","dateCreated":"2019-09-24T01:26:03+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:21749"},{"title":"1.2. mysql 데이터입력","text":"\nval table1 = \"zzdm.order_info\"\n\n\norderInfoDF.write.mode(\"overwrite\").jdbc(url, table1, prop)","user":"anonymous","dateUpdated":"2019-09-24T02:47:56+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"table1: String = zzdm.order_info\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-3-26.ap-northeast-2.compute.internal:4040/jobs/job?id=20"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1569250375638_-731963078","id":"20190923-145255_1633679636","dateCreated":"2019-09-23T14:52:55+0000","dateStarted":"2019-09-24T02:47:56+0000","dateFinished":"2019-09-24T02:47:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21750"},{"title":"2.  user_info.csv db insert ","text":"val userInfoDF = spark.read.option(\"header\",\"true\").\noption(\"inferSchema\", \"true\").\ncsv(\"s3://awskrug-data-njk/csv/user_info.csv\")","user":"anonymous","dateUpdated":"2019-09-24T02:47:05+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"userInfoDF: org.apache.spark.sql.DataFrame = [user_id: string, os: string ... 1 more field]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-3-26.ap-northeast-2.compute.internal:4040/jobs/job?id=16","http://ip-172-31-3-26.ap-northeast-2.compute.internal:4040/jobs/job?id=17"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1569250456681_1099126376","id":"20190923-145416_568210355","dateCreated":"2019-09-23T14:54:16+0000","dateStarted":"2019-09-24T02:47:05+0000","dateFinished":"2019-09-24T02:47:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21751"},{"text":"userInfoDF.printSchema","user":"anonymous","dateUpdated":"2019-09-24T02:47:09+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- user_id: string (nullable = true)\n |-- os: string (nullable = true)\n |-- age: integer (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1569251052217_-1585675668","id":"20190923-150412_1707319570","dateCreated":"2019-09-23T15:04:12+0000","dateStarted":"2019-09-24T02:47:09+0000","dateFinished":"2019-09-24T02:47:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21752"},{"text":"userInfoDF.show","user":"anonymous","dateUpdated":"2019-09-24T02:47:14+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+---+---+\n|             user_id| os|age|\n+--------------------+---+---+\n|--PYPMX8QWg0ioT5z...|And| 41|\n|-16-xXbeDcvkZJtTp...|iOS| 31|\n|-1de9sT-MLwVVvnC0...|iOS| 16|\n|-3A3L2jnM55B_Q1bR...|And| 41|\n|-3bhcSgPOIdQAPkPN...|And| 42|\n|-3fmY1WsLkYJwN_8l...|iOS| 27|\n|-3q-oynqxFEgSHUwX...|And| 22|\n|-428TMckUlhn6ptxN...|iOS| 35|\n|-4O8WnD8dT6nWho-4...|And| -1|\n|-4ltLPS55n6J2wSUC...|And| 17|\n|-5BA0EwkyhGLCC8Fx...|iOS| 21|\n|-5Cwn2Fcx9j16QSM2...|And| 45|\n|-5o3lkvJctT3uURb5...|And| 39|\n|-622WUNWBtjX5VGKx...|iOS| 37|\n|-62U2A3KHjNZ2XXmO...|iOS| 27|\n|-63J8veARgGL3ulnR...|iOS| 33|\n|-6UZWGgl3AAI7Df2s...|iOS| 24|\n|-6jxyh56lSivkbLm3...|iOS| 20|\n|-71z4lG_D-eKnOmDC...|iOS| 33|\n|-75tFsDSoUwapUvwC...|And| 39|\n+--------------------+---+---+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-3-26.ap-northeast-2.compute.internal:4040/jobs/job?id=18"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1569293230694_2044427739","id":"20190924-024710_704339737","dateCreated":"2019-09-24T02:47:10+0000","dateStarted":"2019-09-24T02:47:14+0000","dateFinished":"2019-09-24T02:47:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21753"},{"text":"val table2 = \"zzdm.user_info\"\n\n\nuserInfoDF.write.mode(\"overwrite\").jdbc(url, table2, prop)","user":"anonymous","dateUpdated":"2019-09-24T02:47:48+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"table2: String = zzdm.user_info\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-3-26.ap-northeast-2.compute.internal:4040/jobs/job?id=19"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1569251062110_797186870","id":"20190923-150422_493327875","dateCreated":"2019-09-23T15:04:22+0000","dateStarted":"2019-09-24T02:47:48+0000","dateFinished":"2019-09-24T02:47:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21754"},{"title":"shop_info csv to parquet","text":"val shopInfoDF = spark.read.option(\"header\",\"true\").\noption(\"inferSchema\", \"true\").\ncsv(\"s3://awskrug-data-njk/csv/shop_info.csv\").write.parquet(\"s3://awskrug-data-njk/parquet/shop_info\")","user":"anonymous","dateUpdated":"2019-09-24T02:51:31+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"shopInfoDF: Unit = ()\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-3-26.ap-northeast-2.compute.internal:4040/jobs/job?id=21","http://ip-172-31-3-26.ap-northeast-2.compute.internal:4040/jobs/job?id=22","http://ip-172-31-3-26.ap-northeast-2.compute.internal:4040/jobs/job?id=23"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1569293117646_-984520653","id":"20190924-024517_1404513136","dateCreated":"2019-09-24T02:45:17+0000","dateStarted":"2019-09-24T02:51:31+0000","dateFinished":"2019-09-24T02:51:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21755"},{"title":"goods_info csv to parquet","text":"spark.read.option(\"header\",\"true\").\noption(\"inferSchema\", \"true\").\ncsv(\"s3://awskrug-data-njk/csv/goods_info.csv\").mode(\"overwrite\").option(\"codec\",\"snappy\").write.parquet(\"s3://awskrug-data-njk/parquet/goods_info\")","user":"anonymous","dateUpdated":"2019-09-26T00:58:57+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-3-26.ap-northeast-2.compute.internal:4040/jobs/job?id=24","http://ip-172-31-3-26.ap-northeast-2.compute.internal:4040/jobs/job?id=25","http://ip-172-31-3-26.ap-northeast-2.compute.internal:4040/jobs/job?id=26"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1569293458173_121793539","id":"20190924-025058_234638219","dateCreated":"2019-09-24T02:50:58+0000","dateStarted":"2019-09-24T02:52:24+0000","dateFinished":"2019-09-24T02:52:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21756"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1569293544828_-623490323","id":"20190924-025224_577920266","dateCreated":"2019-09-24T02:52:24+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:21757"}],"name":"rds_insert","id":"2ENRP8A7R","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}